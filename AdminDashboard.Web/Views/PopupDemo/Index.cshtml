@{
    ViewData["Title"] = "Popup Examples";
}

<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-12">
            <h2 class="mb-3">
                <i class="fas fa-window-restore me-2"></i>Popup & Modal Examples
            </h2>
            <p class="text-muted">Comprehensive examples of popups, modals, alerts, and interactive dialogs</p>
        </div>
    </div>

    <!-- Alert Examples Section -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="fas fa-bell me-2"></i>Alert Examples</h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-3">
                            <button type="button" class="btn btn-success w-100" onclick="showSuccessAlert()">
                                <i class="fas fa-check-circle me-2"></i>Success Alert
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button type="button" class="btn btn-danger w-100" onclick="showErrorAlert()">
                                <i class="fas fa-times-circle me-2"></i>Error Alert
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button type="button" class="btn btn-warning w-100" onclick="showWarningAlert()">
                                <i class="fas fa-exclamation-triangle me-2"></i>Warning Alert
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button type="button" class="btn btn-info w-100" onclick="showInfoAlert()">
                                <i class="fas fa-info-circle me-2"></i>Info Alert
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirmation Dialog Section -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-header bg-danger text-white">
                    <h5 class="mb-0"><i class="fas fa-question-circle me-2"></i>Confirmation Dialogs</h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-3">
                            <button type="button" class="btn btn-danger w-100" onclick="showDeleteConfirmation()">
                                <i class="fas fa-trash me-2"></i>Delete Confirmation
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button type="button" class="btn btn-warning w-100" onclick="showLogoutConfirmation()">
                                <i class="fas fa-sign-out-alt me-2"></i>Logout Confirmation
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button type="button" class="btn btn-primary w-100" onclick="showSaveConfirmation()">
                                <i class="fas fa-save me-2"></i>Save Confirmation
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button type="button" class="btn btn-secondary w-100" onclick="showCancelConfirmation()">
                                <i class="fas fa-ban me-2"></i>Cancel Confirmation
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Form Modal Section -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0"><i class="fas fa-edit me-2"></i>Form Modals</h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <button type="button" class="btn btn-success w-100" data-bs-toggle="modal" data-bs-target="#contactFormModal">
                                <i class="fas fa-envelope me-2"></i>Contact Form
                            </button>
                        </div>
                        <div class="col-md-4">
                            <button type="button" class="btn btn-primary w-100" data-bs-toggle="modal" data-bs-target="#userFormModal">
                                <i class="fas fa-user-plus me-2"></i>Add User Form
                            </button>
                        </div>
                        <div class="col-md-4">
                            <button type="button" class="btn btn-info w-100" data-bs-toggle="modal" data-bs-target="#feedbackFormModal">
                                <i class="fas fa-comment me-2"></i>Feedback Form
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- List with Search Section -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0"><i class="fas fa-list me-2"></i>List with Search & Actions</h5>
                </div>
                <div class="card-body">
                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#userListModal">
                        <i class="fas fa-users me-2"></i>Open User List
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Advanced Examples Section -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-header bg-dark text-white">
                    <h5 class="mb-0"><i class="fas fa-magic me-2"></i>Advanced Examples</h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-3">
                            <button type="button" class="btn btn-outline-primary w-100" onclick="showProgressModal()">
                                <i class="fas fa-spinner me-2"></i>Progress Modal
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button type="button" class="btn btn-outline-success w-100" onclick="showMultiStepModal()">
                                <i class="fas fa-tasks me-2"></i>Multi-Step Modal
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button type="button" class="btn btn-outline-warning w-100" data-bs-toggle="modal" data-bs-target="#imageModal">
                                <i class="fas fa-image me-2"></i>Image Gallery
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button type="button" class="btn btn-outline-danger w-100" onclick="showTimedAlert()">
                                <i class="fas fa-clock me-2"></i>Timed Alert
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Contact Form Modal -->
<div class="modal fade" id="contactFormModal" tabindex="-1" aria-labelledby="contactFormModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-success text-white">
                <h5 class="modal-title" id="contactFormModalLabel">
                    <i class="fas fa-envelope me-2"></i>Contact Form
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="contactForm">
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="contactName" class="form-label">Name <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="contactName" required>
                    </div>
                    <div class="mb-3">
                        <label for="contactEmail" class="form-label">Email <span class="text-danger">*</span></label>
                        <input type="email" class="form-control" id="contactEmail" required>
                    </div>
                    <div class="mb-3">
                        <label for="contactMessage" class="form-label">Message</label>
                        <textarea class="form-control" id="contactMessage" rows="4"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancel
                    </button>
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-paper-plane me-2"></i>Send Message
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- User Form Modal -->
<div class="modal fade" id="userFormModal" tabindex="-1" aria-labelledby="userFormModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="userFormModalLabel">
                    <i class="fas fa-user-plus me-2"></i>Add New User
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="userForm">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="userName" class="form-label">Username <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="userName" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="userEmail" class="form-label">Email <span class="text-danger">*</span></label>
                            <input type="email" class="form-control" id="userEmail" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="userRole" class="form-label">Role <span class="text-danger">*</span></label>
                            <select class="form-select" id="userRole" required>
                                <option value="">Select Role</option>
                                <option value="Admin">Admin</option>
                                <option value="Manager">Manager</option>
                                <option value="User">User</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="userStatus" class="form-label">Status</label>
                            <select class="form-select" id="userStatus">
                                <option value="Active">Active</option>
                                <option value="Inactive">Inactive</option>
                            </select>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="userNotes" class="form-label">Notes</label>
                        <textarea class="form-control" id="userNotes" rows="3"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancel
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save me-2"></i>Save User
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Feedback Form Modal -->
<div class="modal fade" id="feedbackFormModal" tabindex="-1" aria-labelledby="feedbackFormModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-info text-white">
                <h5 class="modal-title" id="feedbackFormModalLabel">
                    <i class="fas fa-comment me-2"></i>Send Feedback
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="feedbackForm">
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Rate Your Experience</label>
                        <div class="rating">
                            <i class="fas fa-star star" data-rating="1"></i>
                            <i class="fas fa-star star" data-rating="2"></i>
                            <i class="fas fa-star star" data-rating="3"></i>
                            <i class="fas fa-star star" data-rating="4"></i>
                            <i class="fas fa-star star" data-rating="5"></i>
                        </div>
                        <input type="hidden" id="feedbackRating" value="0">
                    </div>
                    <div class="mb-3">
                        <label for="feedbackCategory" class="form-label">Category</label>
                        <select class="form-select" id="feedbackCategory">
                            <option value="General">General Feedback</option>
                            <option value="Bug">Bug Report</option>
                            <option value="Feature">Feature Request</option>
                            <option value="Support">Support</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="feedbackText" class="form-label">Your Feedback</label>
                        <textarea class="form-control" id="feedbackText" rows="4" required></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancel
                    </button>
                    <button type="submit" class="btn btn-info">
                        <i class="fas fa-paper-plane me-2"></i>Submit Feedback
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- User List Modal with Search -->
<div class="modal fade" id="userListModal" tabindex="-1" aria-labelledby="userListModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header bg-info text-white">
                <h5 class="modal-title" id="userListModalLabel">
                    <i class="fas fa-users me-2"></i>User Management
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <div class="input-group">
                        <span class="input-group-text">
                            <i class="fas fa-search"></i>
                        </span>
                        <input type="text" class="form-control" id="userSearchInput" placeholder="Search by name, email, or role...">
                        <button class="btn btn-primary" type="button" onclick="searchUsers()">
                            <i class="fas fa-search me-2"></i>Search
                        </button>
                    </div>
                </div>
                
                <div id="userListLoading" class="text-center py-4" style="display: none;">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="mt-2">Loading users...</p>
                </div>

                <div id="userListContent">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead class="table-light">
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Role</th>
                                    <th>Status</th>
                                    <th class="text-center">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="userListTableBody">
                                <!-- Users will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                    <div id="noUsersFound" class="alert alert-info" style="display: none;">
                        <i class="fas fa-info-circle me-2"></i>No users found matching your search criteria.
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-2"></i>Close
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Email Modal -->
<div class="modal fade" id="emailModal" tabindex="-1" aria-labelledby="emailModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="emailModalLabel">
                    <i class="fas fa-envelope me-2"></i>Send Email
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="emailForm">
                <input type="hidden" id="emailUserId">
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="emailTo" class="form-label">To</label>
                        <input type="text" class="form-control" id="emailTo" readonly>
                    </div>
                    <div class="mb-3">
                        <label for="emailSubject" class="form-label">Subject <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="emailSubject" required>
                    </div>
                    <div class="mb-3">
                        <label for="emailBody" class="form-label">Message <span class="text-danger">*</span></label>
                        <textarea class="form-control" id="emailBody" rows="5" required></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancel
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-paper-plane me-2"></i>Send Email
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Image Gallery Modal -->
<div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-warning text-dark">
                <h5 class="modal-title" id="imageModalLabel">
                    <i class="fas fa-image me-2"></i>Image Gallery
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row g-3">
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body text-center bg-light" style="height: 200px; display: flex; align-items: center; justify-content: center;">
                                <div>
                                    <i class="fas fa-image fa-4x text-secondary mb-2"></i>
                                    <p class="mb-0">Sample Image 1</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body text-center bg-light" style="height: 200px; display: flex; align-items: center; justify-content: center;">
                                <div>
                                    <i class="fas fa-image fa-4x text-secondary mb-2"></i>
                                    <p class="mb-0">Sample Image 2</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body text-center bg-light" style="height: 200px; display: flex; align-items: center; justify-content: center;">
                                <div>
                                    <i class="fas fa-image fa-4x text-secondary mb-2"></i>
                                    <p class="mb-0">Sample Image 3</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<style>
    .rating {
        font-size: 2rem;
    }
    .rating .star {
        color: #ddd;
        cursor: pointer;
        transition: color 0.2s;
    }
    .rating .star:hover,
    .rating .star.active {
        color: #ffc107;
    }
</style>

<script>
    // Alert Examples
    function showSuccessAlert() {
        Swal.fire({
            icon: 'success',
            title: 'Success!',
            text: 'Your operation completed successfully!',
            confirmButtonColor: '#28a745'
        });
    }

    function showErrorAlert() {
        Swal.fire({
            icon: 'error',
            title: 'Oops...',
            text: 'Something went wrong! Please try again.',
            confirmButtonColor: '#dc3545'
        });
    }

    function showWarningAlert() {
        Swal.fire({
            icon: 'warning',
            title: 'Warning!',
            text: 'This action requires your attention!',
            confirmButtonColor: '#ffc107'
        });
    }

    function showInfoAlert() {
        Swal.fire({
            icon: 'info',
            title: 'Information',
            text: 'Here is some important information for you.',
            confirmButtonColor: '#17a2b8'
        });
    }

    // Confirmation Dialogs
    function showDeleteConfirmation() {
        Swal.fire({
            title: 'Are you sure?',
            text: "You won't be able to revert this!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#dc3545',
            cancelButtonColor: '#6c757d',
            confirmButtonText: 'Yes, delete it!',
            cancelButtonText: 'Cancel'
        }).then((result) => {
            if (result.isConfirmed) {
                $.post('@Url.Action("DeleteItem", "PopupDemo")', { id: 123 }, function(response) {
                    if (response.success) {
                        Swal.fire('Deleted!', response.message, 'success');
                    }
                });
            }
        });
    }

    function showLogoutConfirmation() {
        Swal.fire({
            title: 'Logout?',
            text: "Are you sure you want to logout?",
            icon: 'question',
            showCancelButton: true,
            confirmButtonColor: '#ffc107',
            cancelButtonColor: '#6c757d',
            confirmButtonText: 'Yes, logout',
            cancelButtonText: 'Stay logged in'
        }).then((result) => {
            if (result.isConfirmed) {
                Swal.fire('Logged out!', 'You have been logged out successfully.', 'success');
            }
        });
    }

    function showSaveConfirmation() {
        Swal.fire({
            title: 'Save Changes?',
            text: "Do you want to save your changes?",
            icon: 'question',
            showCancelButton: true,
            confirmButtonColor: '#007bff',
            cancelButtonColor: '#6c757d',
            confirmButtonText: 'Save',
            cancelButtonText: 'Discard'
        }).then((result) => {
            if (result.isConfirmed) {
                Swal.fire('Saved!', 'Your changes have been saved.', 'success');
            } else if (result.isDismissed) {
                Swal.fire('Discarded', 'Your changes were discarded.', 'info');
            }
        });
    }

    function showCancelConfirmation() {
        Swal.fire({
            title: 'Cancel Operation?',
            text: "This will cancel the current operation.",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#6c757d',
            cancelButtonColor: '#007bff',
            confirmButtonText: 'Yes, cancel it',
            cancelButtonText: 'Continue'
        }).then((result) => {
            if (result.isConfirmed) {
                Swal.fire('Cancelled', 'Operation cancelled.', 'info');
            }
        });
    }

    // Contact Form Submit
    $('#contactForm').submit(function(e) {
        e.preventDefault();
        const formData = {
            name: $('#contactName').val(),
            email: $('#contactEmail').val(),
            message: $('#contactMessage').val()
        };

        $.post('@Url.Action("SubmitForm", "PopupDemo")', formData, function(response) {
            $('#contactFormModal').modal('hide');
            if (response.success) {
                Swal.fire('Success!', response.message, 'success');
                $('#contactForm')[0].reset();
            } else {
                Swal.fire('Error!', response.message, 'error');
            }
        });
    });

    // User Form Submit
    $('#userForm').submit(function(e) {
        e.preventDefault();
        $('#userFormModal').modal('hide');
        Swal.fire({
            title: 'Processing...',
            text: 'Creating user account...',
            allowOutsideClick: false,
            didOpen: () => {
                Swal.showLoading();
            }
        });

        setTimeout(function() {
            Swal.fire('Success!', 'User created successfully!', 'success');
            $('#userForm')[0].reset();
        }, 1500);
    });

    // Feedback Form Submit
    $('#feedbackForm').submit(function(e) {
        e.preventDefault();
        const rating = $('#feedbackRating').val();
        if (rating == 0) {
            Swal.fire('Error!', 'Please rate your experience!', 'error');
            return;
        }

        $('#feedbackFormModal').modal('hide');
        Swal.fire('Thank You!', 'Your feedback has been submitted!', 'success');
        $('#feedbackForm')[0].reset();
        $('.star').removeClass('active');
        $('#feedbackRating').val(0);
    });

    // Rating System
    $('.star').click(function() {
        const rating = $(this).data('rating');
        $('#feedbackRating').val(rating);
        $('.star').removeClass('active');
        $('.star').each(function() {
            if ($(this).data('rating') <= rating) {
                $(this).addClass('active');
            }
        });
    });

    $('.star').hover(function() {
        const rating = $(this).data('rating');
        $('.star').each(function() {
            if ($(this).data('rating') <= rating) {
                $(this).css('color', '#ffc107');
            } else {
                $(this).css('color', '#ddd');
            }
        });
    }, function() {
        const currentRating = $('#feedbackRating').val();
        $('.star').each(function() {
            if ($(this).data('rating') <= currentRating) {
                $(this).css('color', '#ffc107');
            } else {
                $(this).css('color', '#ddd');
            }
        });
    });

    // User List Functions
    $('#userListModal').on('shown.bs.modal', function() {
        loadUsers('');
    });

    function loadUsers(search) {
        $('#userListLoading').show();
        $('#userListContent').hide();

        $.get('@Url.Action("GetUsers", "PopupDemo")', { search: search }, function(response) {
            $('#userListLoading').hide();
            $('#userListContent').show();

            if (response.success && response.data.length > 0) {
                let html = '';
                response.data.forEach(function(user) {
                    const statusBadge = user.Status === 'Active' ? 
                        '<span class="badge bg-success">Active</span>' : 
                        '<span class="badge bg-secondary">Inactive</span>';
                    
                    html += `
                        <tr>
                            <td>${user.Id}</td>
                            <td><i class="fas fa-user me-2"></i>${user.Name}</td>
                            <td><i class="fas fa-envelope me-2"></i>${user.Email}</td>
                            <td><span class="badge bg-primary">${user.Role}</span></td>
                            <td>${statusBadge}</td>
                            <td class="text-center">
                                <button class="btn btn-sm btn-info" onclick="viewUser(${user.Id}, '${user.Name}', '${user.Email}')" title="View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-sm btn-primary" onclick="sendEmailToUser(${user.Id}, '${user.Name}', '${user.Email}')" title="Send Email">
                                    <i class="fas fa-envelope"></i>
                                </button>
                                ${user.Status === 'Active' ? 
                                    `<button class="btn btn-sm btn-warning" onclick="deactivateUser(${user.Id})" title="Deactivate">
                                        <i class="fas fa-ban"></i>
                                    </button>` :
                                    `<button class="btn btn-sm btn-success" onclick="activateUser(${user.Id})" title="Activate">
                                        <i class="fas fa-check"></i>
                                    </button>`
                                }
                                <button class="btn btn-sm btn-danger" onclick="deleteUser(${user.Id}, '${user.Name}')" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </td>
                        </tr>
                    `;
                });
                $('#userListTableBody').html(html);
                $('#noUsersFound').hide();
            } else {
                $('#userListTableBody').html('');
                $('#noUsersFound').show();
            }
        });
    }

    function searchUsers() {
        const searchTerm = $('#userSearchInput').val();
        loadUsers(searchTerm);
    }

    $('#userSearchInput').keypress(function(e) {
        if (e.which === 13) {
            searchUsers();
        }
    });

    function viewUser(id, name, email) {
        Swal.fire({
            title: '<strong>User Details</strong>',
            html: `
                <div class="text-start">
                    <p><strong>ID:</strong> ${id}</p>
                    <p><strong>Name:</strong> ${name}</p>
                    <p><strong>Email:</strong> ${email}</p>
                </div>
            `,
            confirmButtonText: 'Close'
        });
    }

    function sendEmailToUser(id, name, email) {
        $('#emailUserId').val(id);
        $('#emailTo').val(`${name} <${email}>`);
        $('#emailSubject').val('');
        $('#emailBody').val('');
        $('#emailModal').modal('show');
    }

    $('#emailForm').submit(function(e) {
        e.preventDefault();
        const userId = $('#emailUserId').val();
        const subject = $('#emailSubject').val();
        const body = $('#emailBody').val();

        $.post('@Url.Action("SendEmail", "PopupDemo")', { userId, subject, body }, function(response) {
            $('#emailModal').modal('hide');
            if (response.success) {
                Swal.fire('Success!', response.message, 'success');
                $('#emailForm')[0].reset();
            } else {
                Swal.fire('Error!', response.message, 'error');
            }
        });
    });

    function activateUser(id) {
        $.post('@Url.Action("ActivateUser", "PopupDemo")', { id }, function(response) {
            if (response.success) {
                Swal.fire('Success!', response.message, 'success');
                loadUsers($('#userSearchInput').val());
            }
        });
    }

    function deactivateUser(id) {
        Swal.fire({
            title: 'Deactivate User?',
            text: "This user will be deactivated.",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#ffc107',
            cancelButtonColor: '#6c757d',
            confirmButtonText: 'Yes, deactivate'
        }).then((result) => {
            if (result.isConfirmed) {
                $.post('@Url.Action("DeactivateUser", "PopupDemo")', { id }, function(response) {
                    if (response.success) {
                        Swal.fire('Deactivated!', response.message, 'success');
                        loadUsers($('#userSearchInput').val());
                    }
                });
            }
        });
    }

    function deleteUser(id, name) {
        Swal.fire({
            title: 'Delete User?',
            text: `Are you sure you want to delete ${name}?`,
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#dc3545',
            cancelButtonColor: '#6c757d',
            confirmButtonText: 'Yes, delete!',
            cancelButtonText: 'Cancel'
        }).then((result) => {
            if (result.isConfirmed) {
                $.post('@Url.Action("DeleteItem", "PopupDemo")', { id }, function(response) {
                    if (response.success) {
                        Swal.fire('Deleted!', response.message, 'success');
                        loadUsers($('#userSearchInput').val());
                    }
                });
            }
        });
    }

    // Advanced Examples
    function showProgressModal() {
        let timerInterval;
        Swal.fire({
            title: 'Processing...',
            html: 'Please wait <b></b> seconds.',
            timer: 3000,
            timerProgressBar: true,
            allowOutsideClick: false,
            didOpen: () => {
                Swal.showLoading();
                const b = Swal.getHtmlContainer().querySelector('b');
                timerInterval = setInterval(() => {
                    b.textContent = Math.ceil(Swal.getTimerLeft() / 1000);
                }, 100);
            },
            willClose: () => {
                clearInterval(timerInterval);
            }
        }).then((result) => {
            if (result.dismiss === Swal.DismissReason.timer) {
                Swal.fire('Complete!', 'Process finished successfully!', 'success');
            }
        });
    }

    function showMultiStepModal() {
        const steps = ['Step 1', 'Step 2', 'Step 3'];
        const Queue = Swal.mixin({
            progressSteps: steps,
            confirmButtonText: 'Next >',
            showCancelButton: true,
            cancelButtonText: 'Cancel'
        });

        (async () => {
            await Queue.fire({
                title: 'Step 1: Personal Info',
                text: 'Enter your name',
                input: 'text',
                currentProgressStep: 0
            });

            await Queue.fire({
                title: 'Step 2: Contact',
                text: 'Enter your email',
                input: 'email',
                currentProgressStep: 1
            });

            await Queue.fire({
                title: 'Step 3: Confirmation',
                text: 'Review and confirm',
                confirmButtonText: 'Finish',
                currentProgressStep: 2
            });

            Swal.fire('Complete!', 'All steps completed!', 'success');
        })();
    }

    function showTimedAlert() {
        let timerInterval;
        Swal.fire({
            title: 'Auto Close Alert',
            html: 'This alert will close in <b></b> seconds.',
            timer: 5000,
            timerProgressBar: true,
            didOpen: () => {
                const b = Swal.getHtmlContainer().querySelector('b');
                timerInterval = setInterval(() => {
                    b.textContent = Math.ceil(Swal.getTimerLeft() / 1000);
                }, 100);
            },
            willClose: () => {
                clearInterval(timerInterval);
            }
        });
    }
</script>
}
